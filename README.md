# Hexagon's webdiff

A Deno-based tool to recursively fetch and analyze web assets, focused on identifying changes or differences (hence the tentative name "webdiff").

**Features**

* **Recursive Fetching:** Starting from one or more seed URLs, the tool fetches the web page(s) and parses them to discover links to other assets (images, stylesheets, scripts).
* **Resource Discovery:** Follows internal links within a target website (or websites) to discover and download connected assets.
* **Basic Analysis:** Currently focuses on:
   - Extracting text content from HTML
   - Detecting images
   - Finding links within the fetched assets
* **Sitemap and robots.txt Parsing:** Can parse `sitemap.xml` and `robots.txt` to assist in the discovery of assets.
* **Report Generation:** Creates analyzed reports for understanding differences between fetched assets. 

## Prerequisites

* Deno ([https://deno.land/](https://deno.land/)) installed on your system.

## Getting Started

1. **Clone the repository:**
   ```bash
   git clone https://github.com/hexagon/webdiff
   ```

2. **Change directory:**
   ```bash
   cd webdiff
   ```

3. **Run the script:**
   ```bash
   deno run main.ts <target_url> --report <filename> --report-only 
   ```
   * Replace `<target_url_1>`, `<target_url_2>` with the actual websites you want to analyze.
   * **Options:**
     * `--delay <milliseconds>` Set a delay between fetches (default: 100ms)
     * `--output <directory>` Specify the output directory (default: "./output")
     * `--verbose` Enable verbose debugging output
     * `--report <filename>` Filename for the generated report (default: "./output/report.json")
     * `--report-only` Generates the report without storing the assets. 

## Example

```bash
deno run -A main.js --output ./my_data --delay 500 https://56k.guru
```

This will crawl `https://56k.guru`, and download all assets into the specified output directory. A `report.json` will also be created.

**Comparing Fetched Versions**

After running the `webdiff` tool on a website at different points in time, you might have two separate output directories. Here's how to use the standard `diff` command to compare them:

```bash
diff -r <directory_1> <directory_2> 
```

* Replace <directory_1> and <directory_2> with the paths to the two output directories generated by webdiff.
* The -r flag tells diff to compare the directories recursively.

**Understanding the Output**

The diff command will output differences it finds between files in the two directories.

* For text files (HTML, CSS, etc.), it will show line-by-line changes.
* For binary files (images, etc.), it will simply indicate that the files differ.

## Contributions

Contributions are welcome! Feel free to open issues or submit pull requests.

## Disclaimer

This tool is in an early development stage. Use it at your own risk, and always respect the `robots.txt` rules of websites you target.

**Let me know if you want me to expand on any particular section or concept!** 
